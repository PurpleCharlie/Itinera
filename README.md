# Itinera — веб‑приложение для планирования и организации путешествий
 
Проект разработан в рамках выпускной квалификационной работы бакалавра.

Приложение объединяет в одном интерфейсе:
- планирование каждой поездки (ведение задач поездки, планирование маршрута);
- имитацию бронирования отелей и авиабилетов;
- персонализированные AI‑рекомендации;
- визуализацию путешествий на карте.

---
## Запуск через Docker Compose
### Запуск одной командой

```bash
docker compose -f https://raw.githubusercontent.com/PurpleCharlie/Itinera/master/docker-compose.yml up -d
```
На хосте должен быть установлен Docker Engine.

---
## Основные возможности
> Позже добавлю примеры функционала и UI
> 
— **Планирование поездок**

— **Задачи поездки (to‑do)**

— **Составление маршрута на карте**

— **Имитация бронирования**
- Поиск отелей по городу и датам через Hotellook API (Travelpayouts).
- Поиск авиабилетов через Aviasales / Travelpayouts API.
- Имитация бронирования:
  - создание записей в базе данных;
  - отправка email‑уведомления пользователю (SMTP);
  - реальные транзакции не выполняются в виду отсутствия коммерческого смысла на данном этапе.

— **Персонализированные AI‑рекомендации**
- Получение текстовых рекомендаций (что посмотреть, чем заняться) на основе:
  - направления поездки;
  - длительности поездки;
  - стиля путешествия;
  - интересов и бюджета пользователя.
- Интеграция с OpenRouter / DeepSeek R1 для генерации рекомендаций.
- Сохранение истории рекомендаций в разрезе поездок (просмотр и удаление).

— **Профиль пользователя**
- Регистрация и авторизация (JWT).
- Хранение и редактирование профиля:
- Использование данных профиля при генерации рекомендаций.

— **Интерфейс и UX**
- Single-Page Application на React + TypeScript.
- Темы: светлая и тёмная (переключатель темы с сохранением выбора).
- Модальные окна для работы с поездками, задачами, маршрутом, бронированием и рекомендациями.
- Адаптивный интерфейс (десктопы + мобильные устройства).

---

## Архитектура

Приложение реализовано как классическое клиент–серверное решение. Фронтенд отправляет fetch-запросы бэкенду напрямую.

### Backend

- **Платформа:** ASP.NET Web API (.NET 7).
- **Архитектурный подход:** многослойная архитектура, ориентированная на принципы Clean Architecture и SOLID.
- **Слои:**
  - `API` — контроллеры, конфигурация, middleware (включая JWT и CORS).
  - `Core` — сущности, интерфейсы репозиториев и сервисов, DTO, бизнес‑логика.
  - `Infrastructure` — реализация репозиториев, сервисов, контекст БД, интеграции с внешними API.
- **Аутентификация и авторизация:** JWT, атрибут `[Authorize]` для защищённых маршрутов.
- **Взаимодействие с внешними сервисами:**
  - Hotellook API — поиск отелей.
  - Aviasales / Travelpayouts API — поиск авиабилетов.
  - OpenRouter (DeepSeek R1) — генерация текстовых AI‑рекомендаций.
  - Контроль лимитов токенов для AI‑модели (адаптивное уменьшение `max_tokens` при ошибках).
- **Тестирование API:** Postman, Swagger, нагрузочное тестирование Apache JMeter.

### Database

- **СУБД:** Microsoft SQL Server Developer.
- **ORM:** Entity Framework Core, подход Code‑First.
- **Основные сущности:**
  - `User` — пользователь и его профиль.
  - `Trip` — поездка.
  - `TripTask` — задачи поездки.
  - `RoutePoint` — точки маршрута (координаты для карты).
  - `HotelBooking` — брони отелей (имитация).
  - `FlightBooking` — брони авиаперелётов (имитация).
  - `RecommendationHistory` — история AI‑рекомендаций.
- Все дочерние сущности жёстко привязаны к `Trip` (через `TripId`) и к `User` — чтобы исключить «висячие» записи.

### Frontend

- **Стек:** React, TypeScript, Vite, Tailwind CSS.
- **Маршрутизация:** `react-router-dom` (страницы: авторизация, список поездок, профиль и др.).
- **Карта:** Leaflet + OpenStreetMap (через React‑обёртку).
- **Взаимодействие с API:** `fetch` + JWT‑токен в заголовке `Authorization: Bearer {token}`.
- **UX‑паттерны:**
  - работа через модальные окна поверх основной страницы;
  - переключатели (вкладки) внутри модального окна: задачи, маршрут, бронирование, рекомендации;
  - анимации появления/скрытия.

---

## Тестирование

**Функциональное тестирование**

- Метод «чёрного ящика».
- Покрыты сценарии:
  - регистрация и авторизация;
  - CRUD операций над поездками, задачами, маршрутами;
  - поиск и имитация бронирований;
  - генерация и хранение AI‑рекомендаций;
  - работа со сменой темы;
  - просмотр и редактирование профиля.
- Все тесты завершились успешно (без критических ошибок).

**Нагрузочное и стресс-тестирование (Apache JMeter)**

- **Нагрузка ~500 одновременных пользователей**:
  - среднее время отклика ≈ 6 мс;
  - ошибок 0%;
  - стабильное время ответа.
- **Стресс‑тест в виде 2000 одновременных пользователей**:
  - среднее время отклика ≈ 513 мс;
  - максимум < 1 секунды;
  - ошибок 0%;
  - сервер сохранил устойчивость.

---

## Разработчик
[GitHub](https://github.com/PurpleCharlie) — [Telegram](https://t.me/PurpleEnigma)
